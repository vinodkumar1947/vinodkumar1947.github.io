<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title id="title">Post — Vinod Kumar Gorrepati</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
<style>
  body{margin:0;background:#0b1220;color:#e2e8f0;font-family:Poppins,system-ui,sans-serif}
  .container{max-width:800px;margin:0 auto;padding:28px 20px}
  .prose h1,h2,h3{margin:1em 0 .4em}
  .prose p, .prose li{line-height:1.8;color:#cbd5e1}
  .prose code{background:#0c1222;padding:.2em .4em;border-radius:6px}
  .meta{opacity:.8;margin-top:6px}
</style>
</head><body>
<div class="container">
  <a href="/blog/">← All posts</a>
  <h1 id="post-title" style="margin:.6em 0 .2em"></h1>
  <div class="meta" id="post-date"></div>
  <div id="tags"></div>
  <article id="content" class="prose" style="margin-top:18px"></article>
</div>

<script type="module">
  const params = new URLSearchParams(location.search);
  const slug = params.get('slug');
  if(!slug){ location.href='/blog/'; }

  const posts = await (await fetch('/posts/posts.json', {cache:'no-store'})).json();
  const meta = posts.find(p=>p.slug===slug);
  if(!meta){ document.getElementById('content').textContent='Post not found.'; throw new Error(); }

  const raw = await (await fetch('/posts/' + meta.file, {cache:'no-store'})).text();

  // Parse front-matter: first '---' block
  function parseFM(src){
    if(!src.startsWith('---')) return [{}, src];
    const end = src.indexOf('\n---', 3);
    if(end === -1) return [{}, src];
    const block = src.slice(3, end).trim();
    const body = src.slice(end+4).trim();
    const fm = {};
    block.split('\n').forEach(line=>{
      const i=line.indexOf(':'); if(i>-1){ const k=line.slice(0,i).trim(); let v=line.slice(i+1).trim();
        if(v.startsWith('[')) try{ v=JSON.parse(v.replace(/'/g,'"')); }catch{}
        fm[k]=v.replace(/^"(.*)"$/,'$1');
      }
    });
    return [fm, body];
  }

  const [fm, body] = parseFM(raw);
  const title = fm.title || meta.title;
  const date  = fm.date  || meta.date;

  document.getElementById('title').textContent = title + ' — Vinod Kumar Gorrepati';
  document.getElementById('post-title').textContent = title;
  document.getElementById('post-date').textContent = new Date(date).toLocaleDateString();
  document.getElementById('tags').innerHTML = (meta.tags||[]).map(t=>`<span style="font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid #1f2937;color:#93c5fd;margin-right:6px">${t}</span>`).join('');

  marked.setOptions({mangle:false, headerIds:true});
  const html = marked.parse(body);
  document.getElementById('content').innerHTML = DOMPurify.sanitize(html);
</script>
</body></html>